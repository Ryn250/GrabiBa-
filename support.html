<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Grabi Ba! â€” Support</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="support.css" />
</head>

<body>
    <div class="container">
        <div class="navbar">
            <div class="brand">
                <div class="logo">GB</div>Grabi Ba!
            </div>
            <div class="navlinks">
                <a href="dashboard.html">Dashboard</a>
                <a href="tracking.html">Driver Tracking</a>
                <a href="history.html">Ride History</a>
                <a href="wallet.html">Wallet</a>
                <a href="profile.html" class="active">Profile</a>
                <a href="support.html">Support</a>
            </div>
        </div>

        <div class="card">
            <h3>Support Center</h3>
            <form id="supportForm" class="form">
                <input id="topic" class="input" placeholder="Topic (e.g. Payment, Driver, Ride)" required />
                <textarea id="message" rows="6" class="input" placeholder="Describe your issue..." required></textarea>
                <button class="btn" type="submit">Submit</button>
            </form>

            <h4 style="margin-top:16px">Previous requests</h4>
            <div id="requests" class="card-list small"></div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        APP.requireAuth();
        const form = document.getElementById('supportForm');
        const reqList = document.getElementById('requests');

        function renderRequests() {
            const s = APP.getSupport();
            reqList.innerHTML = '';
            if (!s.length) { reqList.innerHTML = '<div class="small" style="color:var(--muted)">No open requests</div>'; return; }
            s.forEach(r => {
                const d = document.createElement('div');
                d.className = 'stat';
                d.innerHTML = `<div><div style="font-weight:700">${r.topic}</div><div class="small">${r.time}</div></div><div style="text-align:right">${r.status || 'Open'}</div>`;
                reqList.appendChild(d);
            });
        }
        renderRequests();

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const topic = document.getElementById('topic').value.trim();
            const message = document.getElementById('message').value.trim();
            if (!topic || !message) { alert('Please fill both fields'); return; }
            const obj = { topic, message, time: new Date().toLocaleString(), status: 'Open' };
            APP.addSupport(obj);
            form.reset();
            renderRequests();
            alert('Support request submitted (demo).');
        });

        document.getElementById('logoutBtn').addEventListener('click', (e) => {
            e.preventDefault(); APP.logout(); window.location.href = 'login.html';
        });
    </script>
</body>

</html>